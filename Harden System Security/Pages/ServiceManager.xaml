<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="HardenSystemSecurity.Pages.ServiceManager"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:vm="using:HardenSystemSecurity.ViewModels"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:customUI="using:AppControlManager.CustomUIElements"
    KeyboardAcceleratorPlacementMode="Hidden">

    <Page.KeyboardAccelerators>
        <KeyboardAccelerator Key="F5" Invoked="{x:Bind ViewModel.LoadServices_Accelerator}" />
    </Page.KeyboardAccelerators>

    <Page.Resources>
        <LinearGradientBrush x:Key="CardGradientBorderBrush" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#f0acf7" Offset="0.9" />
            <GradientStop Color="#acf7f0" Offset="0.0" />
        </LinearGradientBrush>

        <Style x:Key="ConfigCardBorderStyle" TargetType="Border">
            <Setter Property="Width" Value="250"/>
            <Setter Property="Height" Value="110"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{StaticResource CardGradientBorderBrush}"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Padding" Value="12"/>
        </Style>

        <Style x:Key="ConfigCardTitleStyle" TargetType="TextBlock" BasedOn="{StaticResource BodyStrongTextBlockStyle}">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="{ThemeResource TextFillColorSecondaryBrush}"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <Style x:Key="ConfigCardCopyButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="6"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <Style x:Key="ConfigCardDataScrollViewerStyle" TargetType="ScrollViewer">
            <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="HorizontalScrollBarVisibility" Value="Disabled"/>
            <Setter Property="Padding" Value="0,0,4,0"/>
        </Style>

        <Style x:Key="ConfigCardDataTextBlockStyle" TargetType="TextBlock">
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="IsTextSelectionEnabled" Value="True"/>
        </Style>
    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- InfoBar -->
        <customUI:InfoBarV2 x:Name="MainInfoBar"
                            Grid.Row="0"
                            Margin="0,0,0,7"
                            Title="Service Manager"
                            Message="{x:Bind ViewModel.MainInfoBarMessage, Mode=OneWay}"
                            Severity="{x:Bind ViewModel.MainInfoBarSeverity, Mode=OneWay}"
                            IsOpen="{x:Bind ViewModel.MainInfoBarIsOpen, Mode=TwoWay}"
                            IsClosable="{x:Bind ViewModel.MainInfoBarIsClosable, Mode=OneWay}"/>

        <!-- Toolbar Area -->
        <controls:WrapPanel Grid.Row="1"
                            Orientation="Horizontal"
                            HorizontalSpacing="2"
                            VerticalSpacing="6"
                            Margin="0,0,0,7">

            <!-- Group 1: Actions -->
            <Border CornerRadius="10"
                    Padding="6,4"
                    BorderThickness="1"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    VerticalAlignment="Center">
                <StackPanel Orientation="Horizontal" Spacing="6">
                    <!-- Progress Ring -->
                    <ProgressRing IsActive="{x:Bind ViewModel.IsLoading, Mode=OneWay}"
                                  Visibility="{x:Bind ViewModel.ProgressRingVisibility, Mode=OneWay}"
                                  VerticalAlignment="Center"                                  
                                  Margin="0,0,8,0" />

                    <!-- Load Services -->
                    <Button Style="{StaticResource AccentButtonStyle}"
                            VerticalAlignment="Center"
                            x:Uid="LoadServicesButton"
                            Click="{x:Bind ViewModel.LoadServices_Click}"
                            IsEnabled="{x:Bind ViewModel.AreElementsEnabled, Mode=OneWay}">
                        <Button.ContentTemplate>
                            <DataTemplate x:DataType="x:String">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE72C;" FontSize="16"/>
                                    <TextBlock Text="{x:Bind}"/>
                                </StackPanel>
                            </DataTemplate>
                        </Button.ContentTemplate>
                    </Button>

                    <!-- Toggle Filters Sidebar -->
                    <ToggleButton VerticalAlignment="Center"
                                  x:Uid="FiltersButton"
                                  IsChecked="{x:Bind ViewModel.IsFilterPanelOpen, Mode=TwoWay}"
                                  IsEnabled="{x:Bind ViewModel.AreElementsEnabled, Mode=OneWay}">
                        <ToggleButton.ContentTemplate>
                            <DataTemplate x:DataType="x:String">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE71C;" FontSize="16"/>
                                    <TextBlock Text="{x:Bind}"/>
                                </StackPanel>
                            </DataTemplate>
                        </ToggleButton.ContentTemplate>
                    </ToggleButton>
                </StackPanel>
            </Border>

            <!-- Group 2: Statistics -->
            <Border CornerRadius="10"
                    Padding="8,8"
                    BorderThickness="1"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    VerticalAlignment="Center">
                <StackPanel Orientation="Horizontal"
                            Spacing="6"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Margin="8,0">
                    <FontIcon Glyph="&#xE74C;"                              
                              Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                              VerticalAlignment="Center"/>
                    <TextBlock VerticalAlignment="Center">
                            <Run x:Uid="TotalText"/>
                            <Run Text="{x:Bind ViewModel.TotalServices, Mode=OneWay}" FontWeight="SemiBold"/>
                    </TextBlock>
                </StackPanel>

            </Border>

            <!-- Group 3: Search and Sort -->
            <Border CornerRadius="10"
                    Padding="6,4"
                    BorderThickness="1"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    VerticalAlignment="Center">
                <StackPanel Orientation="Horizontal" Spacing="6">
                    <!-- Search Box -->
                    <TextBox x:Uid="SearchBoxTextBox"
                             VerticalAlignment="Center"
                             BorderThickness="0"
                             Background="Transparent" 
                             Text="{x:Bind ViewModel.SearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                    <AppBarSeparator VerticalAlignment="Center" Margin="0,4"/>

                    <!-- Sort Selection -->
                    <TextBlock Text="Sort by:" VerticalAlignment="Center" Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="4,0,0,0"/>

                    <ComboBox SelectedIndex="{x:Bind ViewModel.SelectedSortIndex, Mode=TwoWay}"
                              VerticalAlignment="Center"
                              BorderThickness="0"
                              Background="Transparent"
                              Width="120">
                        <ComboBoxItem Content="Name"/>
                        <ComboBoxItem Content="State"/>
                        <ComboBoxItem Content="Start Type"/>
                    </ComboBox>

                    <ToggleButton IsChecked="{x:Bind ViewModel.IsSortDescending, Mode=TwoWay}"
                                  VerticalAlignment="Center"
                                  BorderThickness="0"
                                  Background="Transparent"
                                  ToolTipService.ToolTip="Toggle Ascending/Descending">
                        <FontIcon Glyph="{x:Bind ViewModel.SortDirectionIcon, Mode=OneWay}" FontSize="14"/>
                    </ToggleButton>
                </StackPanel>
            </Border>

        </controls:WrapPanel>

        <!-- SplitView for sidebar filtering -->
        <SplitView Grid.Row="2"
                   IsPaneOpen="{x:Bind ViewModel.IsFilterPanelOpen, Mode=TwoWay}"
                   DisplayMode="Inline"
                   OpenPaneLength="320"
                   PanePlacement="Right"
                   PaneBackground="Transparent">

            <!-- SplitView Pane (Filters Sidebar) -->
            <SplitView.Pane>
                <Grid Padding="16,0,16,16" BorderThickness="1,0,0,0" BorderBrush="{ThemeResource SurfaceStrokeColorDefaultBrush}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Grid Grid.Row="0" Margin="0,8,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="Advanced Filters" Style="{StaticResource SubtitleTextBlockStyle}" VerticalAlignment="Center"/>

                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4" VerticalAlignment="Center">
                            <Button Content="All" ToolTipService.ToolTip="Select All" Click="{x:Bind ViewModel.SelectAllFilters_Click}"/>
                            <Button Content="None" ToolTipService.ToolTip="Deselect All" Click="{x:Bind ViewModel.DeselectAllFilters_Click}"/>
                        </StackPanel>
                    </Grid>

                    <!-- Dynamic Counts Feature Toggle -->
                    <ToggleSwitch Grid.Row="1"
                                  Header="Dynamic Filter Counts"
                                  IsOn="{x:Bind ViewModel.IsDynamicCountEnabled, Mode=TwoWay}"
                                  Margin="0,0,0,16"/>

                    <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto" Padding="0,0,12,0">
                        <ItemsControl ItemsSource="{x:Bind ViewModel.FilterGroups, Mode=OneWay}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="vm:FilterGroupVM">
                                    <Expander Header="{x:Bind GroupName}" IsExpanded="True" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" Margin="0,0,0,8">
                                        <ItemsControl ItemsSource="{x:Bind Filters, Mode=OneWay}">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate x:DataType="vm:FilterItemVM">
                                                    <CheckBox Content="{x:Bind DisplayName, Mode=OneWay}" IsChecked="{x:Bind IsChecked, Mode=TwoWay}" Margin="0,4,0,4"/>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </Expander>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </SplitView.Pane>

            <!-- SplitView Content (Main List Area) -->
            <SplitView.Content>
                <Grid>
                    <!-- Results List -->
                    <ListView ItemsSource="{x:Bind ViewModel.FilteredServices, Mode=OneWay}"
                              SelectionMode="Single">

                        <ListView.Resources>
                            <!-- Disables the Selection indicator on the ListView -->
                            <x:Boolean x:Key="ListViewItemSelectionIndicatorVisualEnabled">False</x:Boolean>

                            <SolidColorBrush x:Key="ListViewItemBackgroundPointerOver" Color="Transparent"/>
                            <SolidColorBrush x:Key="ListViewItemBackgroundPressed" Color="Transparent"/>
                            <SolidColorBrush x:Key="ListViewItemBackgroundSelected" Color="Transparent"/>
                            <SolidColorBrush x:Key="ListViewItemBackgroundSelectedPointerOver" Color="Transparent"/>
                            <SolidColorBrush x:Key="ListViewItemBackgroundSelectedPressed" Color="Transparent"/>
                        </ListView.Resources>

                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                <Setter Property="Padding" Value="4,0,4,0"/>
                                <Setter Property="CornerRadius" Value="8"/>
                            </Style>
                        </ListView.ItemContainerStyle>

                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="vm:ServiceItemViewModel">

                                <Expander HorizontalAlignment="Stretch"
                                          HorizontalContentAlignment="Stretch"
                                          Margin="0,2,0,2">

                                    <!-- Context Flyout for Right Click options -->
                                    <Expander.ContextFlyout>
                                        <MenuFlyout>
                                            <MenuFlyoutSubItem Text="State Control">
                                                <MenuFlyoutSubItem.Icon>
                                                    <FontIcon Glyph="&#xE768;"/>
                                                </MenuFlyoutSubItem.Icon>
                                                <MenuFlyoutItem Text="Start" Tag="{x:Bind}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.StartService_Click}">
                                                    <MenuFlyoutItem.Icon>
                                                        <FontIcon Glyph="&#xE768;"/>
                                                    </MenuFlyoutItem.Icon>
                                                </MenuFlyoutItem>
                                                <MenuFlyoutItem Text="Stop" Tag="{x:Bind}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.StopService_Click}">
                                                    <MenuFlyoutItem.Icon>
                                                        <FontIcon Glyph="&#xE71A;"/>
                                                    </MenuFlyoutItem.Icon>
                                                </MenuFlyoutItem>
                                                <MenuFlyoutItem Text="Pause" Tag="{x:Bind}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.PauseService_Click}">
                                                    <MenuFlyoutItem.Icon>
                                                        <FontIcon Glyph="&#xE769;"/>
                                                    </MenuFlyoutItem.Icon>
                                                </MenuFlyoutItem>
                                                <MenuFlyoutItem Text="Resume" Tag="{x:Bind}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.ResumeService_Click}">
                                                    <MenuFlyoutItem.Icon>
                                                        <FontIcon Glyph="&#xE768;"/>
                                                    </MenuFlyoutItem.Icon>
                                                </MenuFlyoutItem>
                                                <MenuFlyoutItem Text="Restart" Tag="{x:Bind}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.RestartService_Click}">
                                                    <MenuFlyoutItem.Icon>
                                                        <FontIcon Glyph="&#xE72C;"/>
                                                    </MenuFlyoutItem.Icon>
                                                </MenuFlyoutItem>
                                            </MenuFlyoutSubItem>
                                            <MenuFlyoutSeparator />
                                            <MenuFlyoutItem Text="Open in Registry" Tag="{x:Bind}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.OpenInRegistry_Click}">
                                                <MenuFlyoutItem.Icon>
                                                    <FontIcon Glyph="&#xE74C;"/>
                                                </MenuFlyoutItem.Icon>
                                            </MenuFlyoutItem>
                                            <MenuFlyoutItem Text="Browse" Tag="{x:Bind}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.BrowseService_Click}">
                                                <MenuFlyoutItem.Icon>
                                                    <FontIcon Glyph="&#xE8B7;"/>
                                                </MenuFlyoutItem.Icon>
                                            </MenuFlyoutItem>
                                            <MenuFlyoutItem Text="Search" Tag="{x:Bind}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.SearchService_Click}">
                                                <MenuFlyoutItem.Icon>
                                                    <FontIcon Glyph="&#xE721;"/>
                                                </MenuFlyoutItem.Icon>
                                            </MenuFlyoutItem>
                                            <MenuFlyoutItem Text="Security" Tag="{x:Bind}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.SecurityService_Click}">
                                                <MenuFlyoutItem.Icon>
                                                    <FontIcon Glyph="&#xEA18;"/>
                                                </MenuFlyoutItem.Icon>
                                            </MenuFlyoutItem>
                                            <MenuFlyoutSeparator />
                                            <MenuFlyoutItem Text="Delete Service" Tag="{x:Bind}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.DeleteService_Click}">
                                                <MenuFlyoutItem.Icon>
                                                    <FontIcon Glyph="&#xE74D;" Foreground="{ThemeResource SystemFillColorCriticalBrush}"/>
                                                </MenuFlyoutItem.Icon>
                                            </MenuFlyoutItem>
                                        </MenuFlyout>
                                    </Expander.ContextFlyout>

                                    <Expander.Header>
                                        <Grid ColumnSpacing="8" Padding="0,4">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="2*"/>
                                                <ColumnDefinition Width="2*"/>
                                                <ColumnDefinition Width="1*"/>
                                                <ColumnDefinition Width="1.5*"/>
                                            </Grid.ColumnDefinitions>

                                            <!-- Column 0: Service Name -->
                                            <TextBlock Grid.Column="0" Text="{x:Bind Item.ServiceName}" Style="{StaticResource BodyStrongTextBlockStyle}" VerticalAlignment="Center" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" ToolTipService.ToolTip="{x:Bind Item.ServiceName}"/>

                                            <!-- Column 1: Display Name -->
                                            <TextBlock Grid.Column="1" Text="{x:Bind Item.DisplayName}" Style="{StaticResource BodyTextBlockStyle}" VerticalAlignment="Center" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" ToolTipService.ToolTip="{x:Bind Item.DisplayName}"/>

                                            <!-- Column 2: State -->
                                            <TextBlock Grid.Column="2" Text="{x:Bind Item.CurrentState}" FontWeight="SemiBold" Foreground="{x:Bind StateColorBrush}" VerticalAlignment="Center" />

                                            <!-- Column 3: Executable Name -->
                                            <StackPanel Grid.Column="3" Orientation="Horizontal" Spacing="4" VerticalAlignment="Center">
                                                <TextBlock Text="Executable:" Style="{StaticResource CaptionTextBlockStyle}" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                                <TextBlock Text="{x:Bind ExecutableName}" Style="{StaticResource BodyTextBlockStyle}" VerticalAlignment="Center" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" ToolTipService.ToolTip="{x:Bind ExecutableName}"/>
                                            </StackPanel>
                                        </Grid>
                                    </Expander.Header>

                                    <!-- Comprehensive Data shown when expanded -->
                                    <Expander.Content>
                                        <StackPanel Spacing="15">

                                            <!-- View Selector Bar -->
                                            <SelectorBar Loaded="{x:Bind vm:ViewModelProvider.ServiceManagerVM.SelectorBar_Loaded}"
                                                         SelectionChanged="{x:Bind vm:ViewModelProvider.ServiceManagerVM.SelectorBar_SelectionChanged}">
                                                <SelectorBarItem Text="Configuration Details">
                                                    <SelectorBarItem.Icon>
                                                        <FontIcon Glyph="&#xE713;"/>
                                                    </SelectorBarItem.Icon>
                                                </SelectorBarItem>
                                                <SelectorBarItem Text="Portable Executable Metadata" Visibility="{x:Bind PeInfoVisibility, Mode=OneWay}">
                                                    <SelectorBarItem.Icon>
                                                        <FontIcon Glyph="&#xE946;"/>
                                                    </SelectorBarItem.Icon>
                                                </SelectorBarItem>
                                            </SelectorBar>

                                            <!-- Configuration Details Grid -->
                                            <controls:WrapPanel HorizontalSpacing="12" VerticalSpacing="12" Visibility="{x:Bind ConfigDetailsVisibility, Mode=OneWay}">

                                                <!-- Description -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Description" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Description" Tag="{x:Bind Item.Description}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.Description}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- Raw Path -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Raw Path" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Raw Path" Tag="{x:Bind Item.RawPath}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.RawPath}" FontFamily="Consolas" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- Process ID -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Process ID (PID)" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Process ID" Tag="{x:Bind Item.ProcessId}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.ProcessId}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- Start Type -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Start Type" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" Visibility="{x:Bind StartTypeSaveVisibility, Mode=OneWay}" ToolTipService.ToolTip="Save Configuration" Tag="{x:Bind}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.SaveStartType_Click}">
                                                                <FontIcon Glyph="&#xE74E;" FontSize="14" Foreground="{ThemeResource SystemFillColorSuccessBrush}"/>
                                                            </Button>
                                                            <Button Grid.Column="2" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Selection" Tag="{x:Bind Item.StartType}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ComboBox Grid.Row="1" ItemsSource="{x:Bind StartTypes}" SelectedIndex="{x:Bind SelectedStartTypeIndex, Mode=TwoWay}" VerticalAlignment="Center" HorizontalAlignment="Stretch" />
                                                    </Grid>
                                                </Border>

                                                <!-- Service Type -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Service Type" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" Visibility="{x:Bind ServiceTypeSaveVisibility, Mode=OneWay}" ToolTipService.ToolTip="Save Configuration" Tag="{x:Bind}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.SaveServiceType_Click}">
                                                                <FontIcon Glyph="&#xE74E;" FontSize="14" Foreground="{ThemeResource SystemFillColorSuccessBrush}"/>
                                                            </Button>
                                                            <Button Grid.Column="2" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Selection" Tag="{x:Bind Item.ServiceType}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ComboBox Grid.Row="1" ItemsSource="{x:Bind ServiceTypes}" SelectedIndex="{x:Bind SelectedServiceTypeIndex, Mode=TwoWay}" VerticalAlignment="Center" HorizontalAlignment="Stretch" />
                                                    </Grid>
                                                </Border>

                                                <!-- Error Control -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Error Control" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" Visibility="{x:Bind ErrorControlSaveVisibility, Mode=OneWay}" ToolTipService.ToolTip="Save Configuration" Tag="{x:Bind}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.SaveErrorControl_Click}">
                                                                <FontIcon Glyph="&#xE74E;" FontSize="14" Foreground="{ThemeResource SystemFillColorSuccessBrush}"/>
                                                            </Button>
                                                            <Button Grid.Column="2" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Selection" Tag="{x:Bind Item.ErrorControl}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ComboBox Grid.Row="1" ItemsSource="{x:Bind ErrorControls}" SelectedIndex="{x:Bind SelectedErrorControlIndex, Mode=TwoWay}" VerticalAlignment="Center" HorizontalAlignment="Stretch" />
                                                    </Grid>
                                                </Border>

                                                <!-- Launch Protected -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Launch Protected" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" Visibility="{x:Bind LaunchProtectedSaveVisibility, Mode=OneWay}" ToolTipService.ToolTip="Save Configuration" Tag="{x:Bind}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.SaveLaunchProtected_Click}">
                                                                <FontIcon Glyph="&#xE74E;" FontSize="14" Foreground="{ThemeResource SystemFillColorSuccessBrush}"/>
                                                            </Button>
                                                            <Button Grid.Column="2" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Selection" Tag="{x:Bind Item.LaunchProtected}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ComboBox Grid.Row="1" ItemsSource="{x:Bind LaunchProtectedTypes}" SelectedIndex="{x:Bind SelectedLaunchProtectedIndex, Mode=TwoWay}" VerticalAlignment="Center" HorizontalAlignment="Stretch" />
                                                    </Grid>
                                                </Border>

                                                <!-- Service Group -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Service Group" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Service Group" Tag="{x:Bind Item.ServiceGroup}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.ServiceGroup}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- Run As Account -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Run As Account" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Run As Account" Tag="{x:Bind Item.RunAsAccount}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.RunAsAccount}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- Executable Path -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Executable Path" Style="{StaticResource ConfigCardTitleStyle}"/>

                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="File Security" Tag="{x:Bind}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.FileSecurity_Click}" Margin="0,0,4,0">
                                                                <FontIcon Glyph="&#xEA18;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>

                                                            <Button Grid.Column="2" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Executable Path" Tag="{x:Bind Item.CleanPath}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.CleanPath}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- Service Flags -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Service Flags" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Service Flags" Tag="{x:Bind Item.ServiceFlags}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.ServiceFlags}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- Controls Accepted -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Controls Accepted" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Controls Accepted" Tag="{x:Bind Item.ControlsAccepted}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.ControlsAccepted}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- Dependencies -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Dependencies" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Dependencies" Tag="{x:Bind Item.Dependencies}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.Dependencies}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- Service SID Type -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Service SID Type" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Service SID Type" Tag="{x:Bind Item.ServiceSidType}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.ServiceSidType}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- Required Privileges -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Required Privileges" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Required Privileges" Tag="{x:Bind Item.RequiredPrivileges}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.RequiredPrivileges}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- PreShutdown Timeout -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="PreShutdown Timeout" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy PreShutdown Timeout" Tag="{x:Bind Item.PreShutdownTimeout}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.PreShutdownTimeout}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- Exit Codes -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Exit Codes" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Exit Codes" Tag="{x:Bind Item.ExitCodes}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.ExitCodes}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- Triggers -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Triggers" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Triggers" Tag="{x:Bind Item.Triggers}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.Triggers}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- Failure Actions -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Failure Actions" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Failure Actions" Tag="{x:Bind Item.FailureActions}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.FailureActions}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                            </controls:WrapPanel>

                                            <!-- Portable Executable Metadata Grid -->
                                            <controls:WrapPanel HorizontalSpacing="12" VerticalSpacing="12" Visibility="{x:Bind PeDetailsVisibility, Mode=OneWay}">

                                                <!-- 1. File Description -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="File Description" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy File Description" Tag="{x:Bind Item.PeDescription}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.PeDescription}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- 2. Company Name -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Company Name" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Company Name" Tag="{x:Bind Item.PeCompany}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.PeCompany}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- 3. Product Name -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Product Name" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Product Name" Tag="{x:Bind Item.PeProduct}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.PeProduct}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- 4. File Version -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="File Version" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy File Version" Tag="{x:Bind Item.PeVersion}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.PeVersion}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- 5. Product Version -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Product Version" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Product Version" Tag="{x:Bind Item.PeProductVersion}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.PeProductVersion}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- 6. Original Name -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Original Name" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Original Name" Tag="{x:Bind Item.PeOriginalFilename}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.PeOriginalFilename}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- 7. Internal Name -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Internal Name" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Internal Name" Tag="{x:Bind Item.PeInternalName}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.PeInternalName}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- 8. Copyright -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Copyright" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Copyright" Tag="{x:Bind Item.PeLegalCopyright}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.PeLegalCopyright}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- 9. Trademarks -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Trademarks" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Trademarks" Tag="{x:Bind Item.PeLegalTrademarks}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.PeLegalTrademarks}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- 10. Comments -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Comments" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Comments" Tag="{x:Bind Item.PeComments}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.PeComments}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- 11. Private Build -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Private Build" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Private Build" Tag="{x:Bind Item.PePrivateBuild}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.PePrivateBuild}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                                <!-- 12. Special Build -->
                                                <Border Style="{StaticResource ConfigCardBorderStyle}">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid Grid.Row="0" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Special Build" Style="{StaticResource ConfigCardTitleStyle}"/>
                                                            <Button Grid.Column="1" Style="{StaticResource ConfigCardCopyButtonStyle}" ToolTipService.ToolTip="Copy Special Build" Tag="{x:Bind Item.PeSpecialBuild}" Click="{x:Bind vm:ViewModelProvider.ServiceManagerVM.CopyItem_Click}">
                                                                <FontIcon Glyph="&#xE8C8;" FontSize="14" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource ConfigCardDataScrollViewerStyle}">
                                                            <TextBlock Text="{x:Bind Item.PeSpecialBuild}" Style="{StaticResource ConfigCardDataTextBlockStyle}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>

                                            </controls:WrapPanel>

                                        </StackPanel>
                                    </Expander.Content>

                                </Expander>

                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>

                    <!-- Empty State Placeholder -->
                    <Border Visibility="{x:Bind ViewModel.EmptyStatePlaceholderVisibility, Mode=OneWay}"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            CornerRadius="16"
                            Padding="40,32"
                            BorderThickness="1"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}">
                        <StackPanel Spacing="16" HorizontalAlignment="Center">
                            <FontIcon Glyph="&#xE72C;" FontSize="52" HorizontalAlignment="Center" Foreground="{ThemeResource TextFillColorTertiaryBrush}"/>
                            <TextBlock Text="No services loaded" Style="{StaticResource SubtitleTextBlockStyle}" HorizontalAlignment="Center"/>
                            <TextBlock Text="Click 'Load Services' to fetch the list of system services." Style="{StaticResource BodyTextBlockStyle}" HorizontalAlignment="Center" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </SplitView.Content>

        </SplitView>
    </Grid>
</Page>